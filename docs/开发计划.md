# 死了么 APP 开发计划

> 版本: V1.1 MVP  
> 日期: 2026-01-10  
> 状态: 修订版（收敛 MVP 范围）  
> 预计周期: 3-4 周

---

## 1. 项目概览

基于 **MVP 设计原则**，采用极简架构快速验证产品：
- **技术栈**: Flutter + Spring Boot + MySQL
- **部署方式**: 单机部署
- **目标用户量**: < 1万

### 1.1 代码库现状

> [!WARNING]
> **当前代码库与文档存在不一致**，需先完成迁移。

| 项目 | 文档设计 | 现状 | 处理 |
|------|----------|------|------|
| **silemore-app/** | Flutter 3.x | Android 原生 (Kotlin/Compose) | 重建 |
| **silemore-backend/** | Spring Boot 3.x | 空 Maven 项目 | 补齐依赖 |

---

## 2. 开发工具配置

### 2.1 IDE 选择

| 用途 | 工具 | 版本要求 |
|------|------|----------|
| **Flutter 前端开发** | Android Studio | 最新稳定版 (Hedgehog+) |
| **Spring Boot 后端开发** | IntelliJ IDEA | Community 或 Ultimate |

### 2.2 Android Studio 配置（Flutter）

**必装插件:**
| 插件 | 说明 |
|------|------|
| Flutter | Flutter 开发支持、热重载 |
| Dart | Dart 语言支持 |

**SDK 配置:**
- Flutter SDK: 3.x 最新稳定版
- Dart SDK: 随 Flutter 自动安装
- Android SDK: API 33+ (Android 13)

### 2.3 IntelliJ IDEA 配置（Spring Boot）

**必装插件:**
| 插件 | 说明 |
|------|------|
| Spring Boot | Spring 项目支持 |
| Spring Initializr | 快速创建项目 |
| Lombok | 简化 Java 代码 |
| Database Tools | 数据库可视化 (Ultimate 版自带) |

**JDK 配置:**
- JDK 17 (LTS 版本)
- Maven 3.8+

### 2.4 其他开发工具

| 工具 | 用途 |
|------|------|
| MySQL Workbench | 数据库管理 |
| Postman | API 接口测试 |
| Git | 版本控制 |
| Sourcetree / GitKraken | Git 可视化客户端 (可选) |

### 2.5 推荐项目结构

```
sileme/
├── silemore-app/              ← Flutter 项目 (Android Studio 打开)
│   ├── lib/
│   │   ├── main.dart
│   │   ├── pages/
│   │   ├── services/
│   │   └── models/
│   ├── android/
│   ├── ios/
│   └── pubspec.yaml
│
├── silemore-backend/          ← Spring Boot 项目 (IDEA 打开)
│   ├── src/main/java/com/silemore/
│   │   ├── controller/
│   │   ├── service/
│   │   ├── repository/
│   │   └── entity/
│   ├── src/main/resources/
│   └── pom.xml
│
└── docs/                      ← 文档目录
    ├── 需求文档.md
    ├── 详细设计说明书.md
    ├── API接口详细设计.md
    └── 开发计划.md
```

---

## 3. 开发阶段规划

### 阶段一：基础设施搭建（3-4天）

| 任务 | 说明 | 状态 |
|------|------|------|
| 开发环境配置 | JDK 17 + Flutter SDK + MySQL 8.0 | ⬜ 待开始 |
| **前端迁移** | 备份当前 Android 项目，重建为 Flutter | ⬜ 待开始 |
| 后端项目初始化 | 补齐 Spring Boot 依赖，配置 pom.xml | ⬜ 待开始 |
| 数据库初始化 | 执行建表语句，创建 4 张核心表 | ⬜ 待开始 |
| 基础框架配置 | JWT、BCrypt、全局异常处理、日志配置 | ⬜ 待开始 |
| **邮件域名配置** | SPF/DKIM 记录、SendGrid 域名验证 | ⬜ 待开始 |

**里程碑**: 项目可运行，数据库和邮件连接正常

---

### 阶段二：核心后端开发（5-7天）

#### 2.1 用户认证模块（P0）

| 接口 | 方法 | 路径 | MVP | 状态 |
|------|------|------|-----|------|
| 用户注册 | POST | /api/v1/users/register | ✅ | ⬜ 待开始 |
| 用户登录 | POST | /api/v1/users/login | ✅ | ⬜ 待开始 |
| ~~刷新令牌~~ | ~~POST~~ | ~~/api/v1/users/refresh-token~~ | ⏸️ | -- |
| 用户登出 | POST | /api/v1/users/logout | ✅ | ⬜ 待开始 |

#### 2.2 签到模块（P0）

| 接口 | 方法 | 路径 | 状态 |
|------|------|------|------|
| 执行签到 | POST | /api/v1/check-ins | ⬜ 待开始 |
| 获取今日状态 | GET | /api/v1/check-ins/today | ⬜ 待开始 |
| 获取签到历史 | GET | /api/v1/check-ins | ⬜ 待开始 |

#### 2.3 紧急联系人模块（P0）

| 接口 | 方法 | 路径 | 状态 |
|------|------|------|------|
| 添加联系人 | POST | /api/v1/contacts | ⬜ 待开始 |
| 获取联系人列表 | GET | /api/v1/contacts | ⬜ 待开始 |
| 删除联系人 | DELETE | /api/v1/contacts/{id} | ⬜ 待开始 |
| 验证联系人邮箱 | POST | /api/v1/contacts/verify | ⬜ 待开始 |

#### 2.4 预警与定时任务（P0）

| 任务 | Cron 表达式 | 说明 | 状态 |
|------|-------------|------|------|
| 预警检查 | `0 30 0 * * ?` | 每日 00:30 检查未签到用户 | ⬜ 待开始 |
| 签到提醒 | `0 0 20 * * ?` | 每日 20:00 推送签到提醒 | ⬜ 待开始 |
| 邮件服务 | - | 集成 SendGrid/阿里云邮件 | ⬜ 待开始 |

#### 2.5 用户设置模块（P1）

| 接口 | 方法 | 路径 | 状态 |
|------|------|------|------|
| 更新用户设置 | PATCH | /api/v1/users/me/settings | ⬜ 待开始 |
| 暂停/恢复监测 | POST | /api/v1/users/me/pause | ⬜ 待开始 |

**里程碑**: 所有后端接口可通过 Postman 测试

---

### 阶段三：Flutter 前端开发（7-10天）

#### 3.1 基础架构

| 任务 | 说明 | 状态 |
|------|------|------|
| 状态管理配置 | 使用 Riverpod 或 Provider | ⬜ 待开始 |
| 网络请求封装 | Dio + 拦截器 + Token 管理 | ⬜ 待开始 |
| 路由配置 | GoRouter 或 Navigator 2.0 | ⬜ 待开始 |
| 主题与样式 | 定义颜色、字体、组件样式 | ⬜ 待开始 |

#### 3.2 页面开发

| 页面 | 功能 | 优先级 | 状态 |
|------|------|--------|------|
| 启动页 | Logo 展示、版本检查 | P0 | ⬜ 待开始 |
| 登录页 | 邮箱+密码登录 | P0 | ⬜ 待开始 |
| 注册页 | 邮箱注册、密码强度验证 | P0 | ⬜ 待开始 |
| **主页（签到页）** | 大按钮签到、状态显示、连续天数 | P0 | ⬜ 待开始 |
| 紧急联系人页 | 列表展示、添加/删除操作 | P0 | ⬜ 待开始 |
| 添加联系人页 | 表单输入、邮箱验证 | P0 | ⬜ 待开始 |
| 设置页 | 预警天数、提醒时间、暂停监测 | P1 | ⬜ 待开始 |
| 签到历史页 | 日历视图或列表视图 | P1 | ⬜ 待开始 |
| 关于页 | 版本信息、隐私政策 | P2 | ⬜ 待开始 |

**里程碑**: 完整 UI 流程可走通，前后端联调成功

---

### 阶段四：集成测试与部署（3-4天）

| 任务 | 说明 | 状态 |
|------|------|------|
| 前后端联调 | 完整业务流程测试 | ⬜ 待开始 |
| 邮件发送测试 | 验证预警邮件、验证邮件 | ⬜ 待开始 |
| 安全测试 | HTTPS、SQL 注入、XSS 防护 | ⬜ 待开始 |
| 服务器配置 | 阿里云 ECS 2核4G | ⬜ 待开始 |
| Nginx 配置 | 反向代理、SSL 证书 | ⬜ 待开始 |
| 应用部署 | JAR 包部署、启动脚本 | ⬜ 待开始 |
| APP 打包 | iOS TestFlight / Android APK | ⬜ 待开始 |

**里程碑**: MVP 版本上线，可供内测

---

## 3. 关键里程碑时间线

```
┌─────────────────────────────────────────────────────────────────┐
│                        开发周期：3-4 周                           │
├─────────┬─────────┬─────────────────┬─────────────────┬─────────┤
│  Week 1 │  Week 2 │     Week 3      │     Week 4      │ 上线    │
├─────────┼─────────┼─────────────────┼─────────────────┼─────────┤
│ 环境搭建 │ 后端完成 │  前端页面开发    │  联调+部署      │  ✅     │
│ 后端认证 │ 定时任务 │  前后端联调     │  内测修复       │         │
│ 签到接口 │ 邮件服务 │                 │  APP打包       │         │
└─────────┴─────────┴─────────────────┴─────────────────┴─────────┘
```

---

## 4. 技术要点提醒

### 4.1 后端开发要点

- [ ] JWT Token 有效期：普通 24h，rememberMe 7 天
- [ ] 密码加密使用 BCrypt，cost=12
- [ ] 定时任务使用 `@Scheduled` 注解
- [ ] 邮件采用同步发送（MVP 简化）
- [ ] 所有接口添加请求日志

### 4.2 前端开发要点

- [ ] Token 存储使用 flutter_secure_storage
- [ ] 签到按钮需有明显视觉反馈
- [ ] 支持下拉刷新获取最新状态
- [ ] 网络请求失败需友好提示
- [ ] 适配 iOS/Android 双平台

### 4.3 部署要点

- [ ] 使用环境变量存储敏感配置
- [ ] 配置日志轮转，保留 30 天
- [ ] 设置数据库定时备份
- [ ] 配置 HTTPS (Let's Encrypt)

---

## 5. 风险与应对

| 风险 | 概率 | 影响 | 应对措施 |
|------|------|------|----------|
| 邮件服务配额用尽 | 低 | 高 | 使用 SendGrid 免费版（100封/天） |
| **邮件没入垃圾箱** | 中 | 高 | 必须完成 SPF/DKIM 域名验证 |
| 定时任务执行失败 | 中 | 高 | 添加失败重试机制 + 日志监控 |
| 用户增长超预期 | 低 | 中 | 预留数据库扩展方案 |
| App Store 审核延迟 | 中 | 中 | 优先发布 Android 版本 |
| **前端迁移工作量** | 中 | 中 | 跟踪进度，必要时简化 UI |
| **“未签到”计算误报** | 中 | 高 | 明确时区规则，注意暂停期处理 |

---

## 6. 后续版本规划

| 版本 | 功能 | 预计时间 |
|------|------|----------|
| V1.1 | 短信通知 + 微信通知 | +2 周 |
| V1.2 | 智能签到（步数/位置检测） | +3 周 |
| V2.0 | 社区互助 + 健康数据 | +8 周 |

---

## 附录：每日检查清单

- [ ] 代码提交到 Git
- [ ] 更新任务状态
- [ ] 记录遇到的问题
- [ ] 同步进度给团队

---

> 文档维护：请在完成每个任务后更新状态（⬜ → 🔄 → ✅）
